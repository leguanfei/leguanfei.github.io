name: Build and Deploy Hexo Site

# æ§åˆ¶å·¥ä½œæµç¨‹çš„è§¦å‘æ¡ä»¶
on:
  push:
    branches:
      - main # åªæœ‰å½“ main åˆ†æ”¯å‘ç”Ÿ push äº‹ä»¶æ—¶æ‰è§¦å‘
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # ä½¿ç”¨æœ€æ–°çš„ Ubuntu ç³»ç»Ÿä½œä¸ºè¿è¡Œç¯å¢ƒ
    
    # æˆäºˆå·¥ä½œæµç¨‹å‘ä»“åº“å†™å…¥å†…å®¹çš„æƒé™ï¼Œä»¥ä¾¿å°†æ„å»ºå¥½çš„ç½‘ç«™æ¨é€åˆ° gh-pages åˆ†æ”¯
    permissions:
      contents: write
    steps:
      # ç¬¬ä¸€æ­¥ï¼šæ£€å‡ºä½ çš„ä»£ç 
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      # ç¬¬äºŒæ­¥ï¼šè®¾ç½® Node.js ç¯å¢ƒ
      - name: Set up Node.js ğŸŸ©
        uses: actions/setup-node@v4
        with:
          node-version: '22.14.0' # æŒ‡å®šä½¿ç”¨çš„ Node.js ç‰ˆæœ¬
          cache: 'npm'       # ç¼“å­˜ npm çš„ä¾èµ–é¡¹ï¼ŒåŠ å¿«åç»­æ„å»ºé€Ÿåº¦

      # ç¬¬ä¸‰æ­¥ï¼šå®‰è£…é¡¹ç›®ä¾èµ–
      - name: Install Dependencies ğŸ“¦
        run: npm install

      # ç¬¬å››æ­¥ï¼šæ„å»ºé™æ€ç½‘ç«™
      - name: Build Site ğŸ—ï¸
        # æ‰§è¡Œ package.json ä¸­å®šä¹‰çš„ "build" å‘½ä»¤ï¼Œå³ "hexo generate"
        run: npm run build

      # ç¬¬äº”æ­¥ï¼šéƒ¨ç½²åˆ° GitHub Pages
      - name: Deploy to GitHub Pages ğŸš€
        uses: peaceiris/actions-gh-pages@v4
        with:
          # GITHUB_TOKEN æ˜¯ç”± GitHub Actions è‡ªåŠ¨åˆ›å»ºçš„ï¼Œç”¨äºæˆæƒ
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # Hexo ç”Ÿæˆçš„é™æ€æ–‡ä»¶é»˜è®¤æ”¾åœ¨ public ç›®å½•ä¸‹
          publish_dir: ./public